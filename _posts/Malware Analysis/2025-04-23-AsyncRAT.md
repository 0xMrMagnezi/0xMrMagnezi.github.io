---
title: "Malware Analysis - AsyncRat"
classes: wide
header:
  teaser: /assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/unnamed.PNG
ribbon: navy
description: "AsyncRAT Analysis and Reverse Engineering"
categories:
  - Malware Analysis
tags:
  - Trojan
  - Bot
  - Rat
  - CyberChef
toc: true
---
Sample:
```
17a59db354f270147d5da27aa7978a3c
```

# Background
AsyncRAT is a Remote Access Tool (RAT) designed to remotely monitor and control other computers through a secure encrypted connection. 
It provides functionality such as keylogger, remote desktop control, and many other functions. 
In addition, AsyncRAT can be delivered via various methods such as spear-phishing, malvertising, exploit kit and other techniques.

# Static Analysis

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/malwarebazaar entry.PNG alt="Screenshot1" />
    <br>
    <sub>Figure 1: Malware Bazaar Entry</sub>
</div>
<br>

This sample was first uploaded from the Netherlands and has continued to spread, with notable activity especially in Israel.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/content of the js.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 2: First Stage Code</sub>
</div>
<br>

The first stage uses a relatively simple split and join technique to construct a new string.
To disable the original functionality and observe variable values, I modified the code to use console.log, as shown in Figure 3.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/modified js to disarm.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 3: Disarmed JS Code</sub>
</div>
<br>

In addition, I used a neat trick: I opened the browser's developer tools and ran the code directly there to observe the output, as demonstrated in Figure 4.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/running the js on dev tool.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 4: Dev Tool Code</sub>
</div>
<br>

These results uncovered a Pastebin URL used to retrieve the second stage of the malware.

# Second Stage

The Second stage features heavily obfuscated code, containing around 7,500 lines, intended to obstruct analysis and evade detection.
As shown in Figure 5, this snippet represents a small segment of the heavily obfuscated code.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/heavily obfusacted code downloaded from first stage.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 5: Obfuscated Code</sub>
</div>
<br>

The majority of the obfuscation techniques involved injecting junk code to mask the malwareâ€™s original functionality.
After removing the junk code, what remained was a simple function that modifies a string and a long string. 
In the final step, the code is executed using WScript as shown in Figure 6.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/deobuscating the 2nd stage.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 6: Clearing The Code</sub>
</div>
<br>

Using CyberChef, I was able to replicate the functionality of the previously observed string manipulation.
This revealed the type of manipulation applied to the long string: it replaces a specific word with the letter 'A' and then decodes the result from Base64.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/using the functionnality of the function to decode using replace with null bytes.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 7: CyberChef Extraction</sub>
</div>
<br>

Next, I took the long string and applied the manipulation uncovered earlier, which revealed what appears to be a reversed URL, as shown in Figure 8.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/decoding the long base64 encoded with replacing word with A.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 8: CyberChef to decode the string</sub>
</div>
<br>

Downloading the content hosted at that URL revealed a long, reversed Base64-encoded string. 
After decoding it, a new executable file was uncovered, as shown in Figure 9.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/reversing and decoding base64 string outputs new exe file.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 9: Outputs New EXE</sub>
</div>
<br>

# Third Stage

The third stage of the malware is written in .NET and is most likely the unpacked version of the final payload.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/DIE on the exe.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 10: Using Detect it Easy</sub>
</div>
<br>

Figure 11 highlights the capabilities of the RAT, including C2 communication, code execution, debugging features, and more.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/capabilities of the exe.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 11: Capabilities Of The RAT</sub>
</div>
<br>

Given that the malware was written in .NET, I used dnSpy to decompile and analyze the code, which allowed me to extract the full configuration, as presented in Figure 12.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/all settings of asyncrat.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 12: Settings Configuration Of AsyncRAT</sub>
</div>
<br>

As expected from a RAT, it also collects various environment details such as the hostname, user ID, and more.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/Gets HardwareID and system information.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 13: System Information</sub>
</div>
<br>

# Dynamic Analysis

Once executed, the RAT attempts to establish a connection on port 5090 at regular intervals, as observed in TCPView and shown in Figure 14.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/tcp view shows trying connection.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 14: TCPView Output</sub>
</div>
<br>

The network communication can also be observed using Wireshark, providing further insight into the RAT's connection attempts.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/wireshark dns request.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 15: Using WireShark</sub>
</div>
<br>

# IOCs

- Hash:
```
17a59db354f270147d5da27aa7978a3c
40fb01ac9879cf7ea9e9a375bd525a66
```
- URL
```
hxxps://paste[.]ee/d/1Juiw3uF/0
hxxps://paste[.]ee/d/m6drh6pM/0
deadpoolstart2050[.]duckdns[.]org
```

# Extras

Curious about what AsyncRAT looks like from the attacker's perspective?
The following images provide a glimpse into the control panel of the AsyncRAT server, highlighting some of its core functionalities.

<div style="text-align: center;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/RAT Server.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 16: RAT GUI</sub>
</div>
<br>

<div style="text-align: center; display: inline-block;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/options 1.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 17: RAT Options</sub>
</div>

<div style="text-align: center; display: inline-block;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/options 2.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 18: RAT Options</sub>
</div>

<div style="text-align: center; display: inline-block;">
    <img src="/assets/images/2025-04-23-MalwareAnalysis_AsyncRAT/options 3.PNG" alt="Screenshot1" />
    <br>
    <sub>Figure 19: RAT Options</sub>
</div>

