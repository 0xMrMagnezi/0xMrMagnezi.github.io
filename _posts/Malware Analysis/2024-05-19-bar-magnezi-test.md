---
title: "Malware Analysis - Agent Tesla"
classes: wide
header:
  teaser: /assets/images/MalwareAnalysis_AgentTesla_01/AgentTeslaPic_01.jpg
ribbon: pink
description: "Agent Tesla"
categories:
  - Malware Analysis
tags:
  - Trojan
  - Bot
toc: true
---
Sample:
```
380c9e85f6960add801843076c33ec3b
```

# Background
Agent Tesla is a widely-used remote access Trojan (RAT) known for its keylogging and data exfiltration capabilities, often used in cyber espionage and information theft.
In this report I will Analyze an AgentTesla Sample that was uploaded to MalwareBazaar.

# Static Analysis
<div style="text-align: center;">
    <img src="/assets/images/MalwareAnalysis_AgentTesla_01/MalwareBazzaarEntry.png" alt="Screenshot1" />
    <br>
    <sub>Figure 1: Malware Bazaar Entry</sub>
</div>
<br>
The file was downloaded and extracted. Just from looking at it I noticed that I’m dealing with JS and PowerShell code. I assumed that trying to deobfuscate this .BAT file would be a waste of time. So I ran it in order to capture the PowerShell script that was being executed.

<div style="text-align: center;">
    <img src="/assets/images/MalwareAnalysis_AgentTesla_01/obfuscatedBat.png" alt="Screenshot1" />
    <br>
    <sub>Figure 2: Obfuscated .BAT file</sub>
</div>
<br>
<br>
# Dynamic Analysis

As I suspected the PS was starting under the cmd.exe (.BAT) , so I extracted it from the command line. Also its important to note that the original BAT file was deleted after execution.

<div style="text-align: center;">
    <img src="/assets/images/MalwareAnalysis_AgentTesla_01/obfuscatedBat.png" alt="Screenshot1" />
    <br>
    <sub>Figure 3: Capture of the PS that was being executed</sub>
</div>
<br>



